<openerp>
    <data>
        
<!--        <record model="ir.ui.view" id="view_crm_casualty_vehicle_form_inherit">-->
<!--            <field name="name">crm.casualties.vehicle.form.inherit</field>-->
<!--            <field name="model">crm.claim</field>-->
<!--            <field name="inherit_id" ref="crm_claim.crm_case_claims_form_view"/>-->
<!--            <field name="arch" type="xml">-->
<!--                <field name="vehicle_claim_id" position="replace">-->
<!--                    <field name="vehicle_id"/>-->
<!--                </field>-->
<!--                <field name="date" position="after">-->
<!--                    <field name="type_id"/>-->
<!--                </field>-->
<!--            </field>-->
<!--        </record>-->

        <record model="ir.ui.view" id="view_vehicle_casualties_tree">
            <field name="name">crm.claim.vehicle.tree</field>
            <field name="model">crm.claim</field>
            <field name="arch" type="xml">
                <tree string="Vehicle Casualties" colors="blue:state=='pending' and not(date_deadline and (date_deadline &lt; current_date));gray:state in ('close', 'cancel');red:date_deadline and (date_deadline &lt; current_date)">
                    <field name="name"/>
                    <field name="vehicle_id"/>
                    <field name="type_id"/>
                    <field name="partner_id"/>
                    <field name="user_id"/>
                    <field name="date"/>
                    <field name="stage_id"/>
                    <field name="date_action_next"/>
                    <field name="action_next"/>
                    <field name="categ_id" string="Type"/>
                    <field name="date_deadline" invisible="1"/>
                    <field name="date_closed" invisible="1"/>
                    <field name="state" groups="base.group_no_one"/>
                </tree>

            </field>
        </record>
            <record model="ir.ui.view" id="view_fleet_vehicle_casualties_form_inherit">
            <field name="name">fleet.vehicle.casualties.form.inherit</field>
            <field name="model">fleet.vehicle</field>
            <field name="inherit_id" ref="fleet_special_equipment.view_fleet_vehicle_form_inherit"/>
            <field name="arch" type="xml">
                <xpath expr="/form/sheet/notebook/page[@string='Equipment']" position="after">
                        <page string="Casualties">
                            <field name="casualties_ids"/>
                        </page>
                </xpath>
            </field>
        </record>   

<!--Casualties action inherited from crm.claim-->
        <record model="ir.actions.act_window" id="crm_case_categ_casualty">
            <field name="name">Casualties</field>
            <field name="res_model">crm.claim</field>
            <field name="view_mode">tree,calendar,form</field>
            <field name="view_id" ref="fleet_vehicle_casualties.view_vehicle_casualties_tree"/>
            <field name="context">{"search_default_user_id":uid, "is_vehicle":True}</field>
            <field name="search_view_id" ref="crm_claim.view_crm_case_claims_filter"/>
            <field name="domain">[('type_id','!=',False)]</field>
            <field name="help">Record and track your vehicles casualties. Casualties may be linked to an accident, being this accidents or incidents, manageing states of the paperwork and fiscal issues related to it. You can send emails with attachments and keep the full history for a casualty (emails sent, intervention type and so on). Casualties may automatically be linked to an email address using the mail gateway module.</field>
        </record>


        <menuitem name="Vehicle Casualties" id="menu_crm_case_claims"
            parent="fleet.fleet_vehicles" action="crm_case_categ_casualty" sequence="10"/>
    </data>
</openerp>
